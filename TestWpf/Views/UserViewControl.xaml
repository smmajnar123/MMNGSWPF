<UserControl x:Class="TestWpf.Views.UserViewControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:views="clr-namespace:TestWpf.Views"
             Background="#F0F2F5">

    <UserControl.Resources>

        <!-- 2D DataGrid Header Style -->
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#FFD6D6D6" Offset="0"/>
                        <GradientStop Color="#FFBFBFBF" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- 2D Row Style -->
        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EDEDED"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- TopBar Button Style -->
        <Style x:Key="TopBarButton" TargetType="Button">
            <Setter Property="Height" Value="34"/>
            <Setter Property="Width" Value="34"/>
            <Setter Property="Background" Value="#FF7A5C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Shadow effect -->
        <DropShadowEffect x:Key="ShadowEffect" BlurRadius="6" ShadowDepth="1" Opacity="0.15"/>

    </UserControl.Resources>

    <Grid Margin="10" RowDefinitions="Auto,*">

        <!-- ⭐ TOP BAR ⭐ -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,10" VerticalAlignment="Center">

            <!-- ADD -->
            <Button Style="{StaticResource TopBarButton}"
                    Content="+"
                    ToolTip="Add User"
                    Background="#4CAF50"
                    Click="AddUser_Click"/>

            <!-- EDIT -->
            <Button Style="{StaticResource TopBarButton}"
                    Content="✎"
                    ToolTip="Edit User"
                    Background="#FF9800"
                    x:Name="EditButton"
                    IsEnabled="False"
                    Click="EditUser_Click"/>

            <!-- DELETE -->
            <Button Style="{StaticResource TopBarButton}"
                    Content="🗑"
                    ToolTip="Delete User"
                    Background="#E53935"
                    IsEnabled="False"/>

            <!-- Spacer -->
            <StackPanel Width="30"/>

            <!-- SEARCH BOX -->
            <Border Background="White" CornerRadius="6" Padding="4" Width="220" Height="34"
                    BorderBrush="#D0D0D0" BorderThickness="1">
                <DockPanel>
                    <TextBox x:Name="SearchBox"
                             Background="Transparent"
                             BorderThickness="0"
                             VerticalAlignment="Center"
                             FontSize="14"
                             Padding="4"/>
                </DockPanel>
            </Border>

            <!-- SEARCH BUTTON -->
            <Button Style="{StaticResource TopBarButton}"
                    Width="40"
                    Content="🔍"
                    Background="#607D8B"
                    Click="Search_Click"/>

        </StackPanel>

        <!-- ⭐ DATA GRID ⭐ -->
        <DataGrid x:Name="UserGrid"
                  Grid.Row="1"
                  ItemsSource="{Binding Users}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  HeadersVisibility="Column"
                  RowHeight="40"
                  AlternatingRowBackground="#F6F6F6"
                  GridLinesVisibility="None"
                  Background="White"
                  BorderBrush="#DDD"
                  BorderThickness="1"
                  SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                  SelectionChanged="DataGrid_SelectionChanged">

            <DataGrid.Columns>
                <DataGridTextColumn Header="User ID" Binding="{Binding UserId}" Width="*" />
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="1.5*" />
                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="2*" />
                <DataGridTextColumn Header="Phone" Binding="{Binding Phone}" Width="*" />
                <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="2*" />
                <DataGridTextColumn Header="Father Phone" Binding="{Binding FatherPhone}" Width="*" />
            </DataGrid.Columns>

        </DataGrid>

        <!-- 🌟 POPUP OVERLAY 🌟 -->
        <Grid x:Name="PopupOverlay"
              Background="#80000000"
              Visibility="Collapsed"
              Grid.RowSpan="2">

            <views:UserPupUpViewControl x:Name="PopupContent"/>
        </Grid>
    </Grid>
</UserControl>
